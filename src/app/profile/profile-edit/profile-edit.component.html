<md-toolbar>
    <app-navigation></app-navigation>
    <app-title></app-title>
    <div class="toolbar-icon-spacer"></div>
    <button md-icon-button [routerLink]="['/profile', 'delete']"><app-icon name="trash"></app-icon></button>
</md-toolbar>


<form [formGroup]="profileForm" (ngSubmit)="onSubmit()">
    <!-- First name -->
    <md-input-container [dividerColor]="
                profileForm.controls.firstName.valid ||
                profileForm.controls.firstName.pristine ?
                'primary' : 'warn'" #firstNameContainer>
        <input mdInput
            #firstName
            formControlName="firstName"
            placeholder="First name"
            required
            type='text'>
        <md-hint *ngIf="firstNameContainer._control.focused" align="end">
            <span *ngIf="profileForm.controls.firstName.errors?.required">
                required
            </span>
            <span *ngIf="!profileForm.controls.firstName.errors?.required">
                {{ firstName.value.length }} / 30
            </span>
        </md-hint>
    </md-input-container>
    <br>

    <!-- Last name -->
    <md-input-container [dividerColor]="
            profileForm.controls.lastName.valid ||
            profileForm.controls.lastName.pristine ?
            'primary' : 'warn'" #lastNameContainer>
        <input mdInput
            #lastName
            formControlName="lastName"
            placeholder="Last name"
            required
            type='text'>
        <md-hint *ngIf="lastNameContainer._control.focused" align="end">
            <span *ngIf="profileForm.controls.lastName.errors?.required">
                required
            </span>
            <span *ngIf="!profileForm.controls.lastName.errors?.required">
                {{ lastName.value.length }} / 30
            </span>
        </md-hint>
    </md-input-container>
    <br>

    <!-- Bio -->
    <md-input-container [dividerColor]="profileForm.controls.bio.valid ? 'primary' : 'warn'" #bioContainer>
        <textarea mdInput
            #bio
            type='text'
            formControlName="bio"
            placeholder="Tell us about your soccer skillz...">
            <md-hint *ngIf="bioContainer._control.focused" align="end">
                {{ bio.value.length }} / 1000
            </md-hint>
        </textarea>
    </md-input-container>
    <br>

    <!-- birthday -->
    <md-input-container>
        <input mdInput
            placeholder='Date of birth'
            type='date'
            formControlName='birthday'>
    </md-input-container>
    <br>

    <div *ngIf="editPassword">
        <md-input-container #passwordContainer
                [dividerColor]="getPasswordDividerColor('password')">
            <input mdInput
                   #password
                   formControlName="password"
                   placeholder="New password"
                   required
                   type='password'>
            <md-hint *ngIf="passwordContainer._control.focused" align="end">
                <span *ngIf="profileForm.controls.password.errors?.required && profileForm.controls.password.dirty">required</span>
                <span *ngIf="profileForm.controls.password.errors?.minlength && password.value.length > 0">min 6 symbols</span>
                <span *ngIf="profileForm.errors?.different_passwords">different passwords</span>
                <span *ngIf="!profileForm.controls.password.errors?.required">{{ password.value.length }} / 30</span>
            </md-hint>
        </md-input-container>
        <br>
        <md-input-container #repeatPasswordContainer
                [dividerColor]="getPasswordDividerColor('repeatPassword')">
            <input mdInput
                   #repeatPassword
                   formControlName="repeatPassword"
                   placeholder="Repeat password"
                   required
                   type='password'>
            <md-hint *ngIf="repeatPasswordContainer._control.focused" align="end">
                <span *ngIf="profileForm.controls.repeatPassword.errors?.required && profileForm.controls.repeatPassword.dirty">required</span>
                <span *ngIf="profileForm.controls.repeatPassword.errors?.minlength && repeatPassword.value.length > 0">min 6 symbols</span>
                <span *ngIf="profileForm.errors?.different_passwords">different passwords</span>
                <span *ngIf="!profileForm.controls.repeatPassword.errors?.required">{{ repeatPassword.value.length }} / 30</span>
            </md-hint>
        </md-input-container>
        <br>
    </div>

    <div class="buttons">
        <button md-button type="button" (click)="changePassword()">
            {{ editPassword ? 'Do not change password' : 'Change password'}}
        </button>
        <button
            (click)="onCancel()"
            md-raised-button>
            Cancel
        </button>
        <button
            [disabled]="profileForm.invalid"
            color="primary"
            md-raised-button
            type="submit">
            Save
        </button>
    </div>
</form>
